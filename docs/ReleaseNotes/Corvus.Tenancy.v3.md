# Release notes for Corvus.Tenancy v3.

## v3.7

Dependency updates:

* `Corvus.Storage.Common` 1.5 -> 1.6
* `Corvus.Storage.Azure.Cosmos` 1.5 -> 1.6
* `Corvus.Storage.Azure.BlobStorage` 1.5 -> 1.6
* `Corvus.Storage.Azure.TableStorage` 1.5 -> 1.6
* `Corvus.Storage.Sql` 1.5 -> 1.6

This has the effect of bringing in the following updates:

* `Azure.Data.Tables` 12.7 -> 12.8
* `Azure.Storage.Blobs` 12.14 -> 12.16
* `Microsoft.Azure.Cosmos` 3.31 -> 3.33
* `Microsoft.Data.SqlClient` 5.0 -> 5.1

## v3.6

Dependency updates:

* `Corvus.Storage.Azure.Cosmos` 1.4 -> 1.5
* `Corvus.Storage.Azure.BlobStorage` 1.4 -> 1.5
* `Corvus.Storage.Azure.TableStorage` 1.4 -> 1.5
* `Corvus.Storage.Sql` 1.4 -> 1.5

This has the effect of bringing in the following updates:

* `Corvus.Identity` 1.4 -> 1.5
* `Azure.Identity` 1.6 -> 1.8
* `Azure.Security.KeyVault.Secrets` 4.3 -> 4.4
* `Microsoft.IdentityClient` 4.39 -> 4.46
* `Microsoft.IdentityClient.Extensions.Msal` 2.19 -> 2.23

## v3.5

Dependency updates:

* `Corvus.ContentHandling.Json` 2.0 -> 3.0 (upgrades `Newtonsoft.Json` from 11 to 13)
* `Corvus.Storage.Azure.Cosmos` 1.3 -> 1.4
* `Corvus.Storage.Azure.BlobStorage` 1.3 -> 1.4
* `Corvus.Storage.Azure.TableStorage` 1.3 -> 1.4
* `Corvus.Storage.Sql` 1.3 -> 1.4

Although the `Corvus.ContentHandling.Json` (and corresponding `Newtonsoft.Json`) upgrade are both major version bumps, there are no significant changes in API surface area. The biggest difference is likely to be more nullability warnings as a result of `Newtonsoft.Json` 13.0.1 including nullability annotations, but these do not have any runtime impact. Since this is not really a major change, we didn't want to impose a new major version number on tenancy. (Also, we plan to move away from `Newtonsoft.Json` to `System.Text.Json` as early as possible, and that's when we expect the next major version bump.)


## v3.4

Enables the tenant property key names that were generated by the V2 libraries to be discovered by code using the V3 libraries. (This is useful in scenarios where applications want to move to V3 while continuing to support tenants already using V2-style configuration.)

## v3.3

Enables tenanted container and table names (logical or, where applicable, hashed) to be obtained for a tenant ID (instead of being required to pass an `ITenant`).

## v3.2

Adds support for Azure Tables.

## v3.1

Adds support for SQL Databases.

Adds missing DI initialization method for tenanted Cosmos DB storage. (Applications could previously call `AddCosmosContainerSourceFromDynamicConfiguration` but there's now an `AddTenantCosmosConnectionFactory` method similar to `AddTenantBlobContainerFactory` and `AddTenantSqlConnectionFactory`.)


## v3.0

Targets .NET 6.0 only.
Initial support for Azure Storage Blobs, and Cosmos DB (SQL) only. Other providers currently slated for v3.1.
Uses new-style (Azure.Core) Azure Client SDK—no more dependencies on deprecated client libraries.
Use `Corvus.Identity` v3.0 to enable use of Azure AD client identities (not possible with `Corvus.Tenancy` v2) or to retrieve access keys or connection strings from Key Vault (v2 had limited support for this)
Automatic container creation no longer occurs—see ADR0003 (but v2-v3 transition support is available—see ADR0004)
Support for key rotation scenarios (applications can report that a container no longer works, and that all cached credential information should be discarded, refetching all details from key vault or other sources)


### Breaking changes

This is very different from v2, and upgrading will require rework, because every one of the new features described above is a breaking change.